<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.min.css'>
    <style type="text/css">
      html, body {
        width: 100%;
        height: 100%;
        background-color: transparent;
      }
      .vertical-align-middle {
        display: flex;
        flex-flow: column;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
      }
      .my-form {
        width: 100%;
        max-height: 100%;
        overflow: auto;
        padding: 1rem;
      }
      .form-control, .btn {
        border-radius: 8px;
      }
      .btn[type="submit"], #eval_form_1 {
        background-color: #005a97; /* Barva talčítka */
        color: white; /* Barva textu tlačítka */
        
      }
      #eval_form_1 {
        width: 200px;
        margin: 0 auto;
      }
      /* #page_1 {
        width: 100%;
      } */
      .form-text {
        text-align: center;
        padding: 0 20px;
        display: block;
      }
      .form-text.form3-text {
          margin-top: 20px;
      }
      #form1 {
          width: 160px;
        margin: 0 auto;
      }
      #form2, #form2_wrapper {
        width: 100%;
      }
      #form2 {
          padding: 20px;
      }
      .bold {
          font-weight: bold;
      }
      .call-buttons {
          margin: 20px auto 0;
          text-align: center;
      }
      .call-button {
          width: 150px;
      }
    </style>
  </head>

  <body>
    <div class="vertical-align-middle">
        <div id="form1_wrapper">
            <p class="form-text">Byly Vám naši operátoři nápomocní?</p>
            <form id="form1" class="my-form">

                    <div class="form-check">
                        <label for="value3" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="value3" value="3">
                        Naprosto</label>
                    </div>

                    <div class="form-check">
                        <label for="value2" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="value2" value="2">            
                        Do jisté míry</label>
                    </div>

                    <div class="form-check">
                        <label for="value1" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="value1" value="1">            
                        Nikoliv</label>
                    </div>
            
            </form>
            <button type="button" class="btn btn-info btn-block" id="eval_form_1">Pokračovat</button>
        </div>

        <div id="form2_wrapper" style="display: none !important">
            <p class="form-text">Děkujeme za Vaši zpětnou vazbu.</p>
            <p class="form-text" class="bold">Přejete si poslat přepis emailové konverzace?</p>
            <form class="my-form" id="form2">
                <div class="form-group">
                    <label for="sendConversationEmail" class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="check_form2" value="">            
                    Chci poslat přepis konverzace</label>
                    <input type="email" class="form-control" id="email_form2" placeholder="Email">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-info btn-block" id="submit_form2">Pokračovat</button>                        
                </div>
            </form>
        </div>

        <div id="form3_wrapper" style="display: none !important">
            <p class="form-text form3-text">Je nám líto, že jsme Vám nedokázali pomoci.</p>          
            <p class="form-text form3-text">Chcete, abychom Vás ještě jednou kontaktovali a na věc se znovu podívali?</p>
            <div class="call-buttons">
                <button type="button" class="btn btn-success call-button" id="call-yes">Ano</button>
                <button type="button" class="btn btn-danger call-button" id="call-no">Ne</button> 
            </div> 
           
        </div>

        <div id="form4_wrapper" style="display: none !important">
            <form id="form4" class="my-form">

                <div class="form-group">
                    <label for="phone">Vyplňte, prosím, Vaše telefonní číslo, kam Vám můžeme zavolat.</label>
                    <input type="text" class="form-control" id="phone-form4" placeholder="Telefon" required>
                </div>
                <div class="form-group">
                    <label for="reason">Popiště prosím, v čem Vám můžeme pomoci.</label>
                    <textarea cols="30" rows="5" class="form-control" id="reason-form4" placeholder="Zde můžete popsat Váš problém"></textarea>
                </div>
                
                <button type="submit" class="btn btn-info btn-block" id="submit_form_4">Zavolejte mi</button>
            </form>
        </div>
            
    </div>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.0.8/popper.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/js/bootstrap.min.js'></script>
    <script type="text/javascript">
        const form1wrapper = document.getElementById('form1_wrapper');
        const form2wrapper = document.getElementById('form2_wrapper');
        const form3wrapper = document.getElementById('form3_wrapper');
        const form4wrapper = document.getElementById('form4_wrapper');

        const buttonEvaluation = document.getElementById('eval_form_1');

        const form1_val1 = document.getElementById('value1');
        const form1_val2 = document.getElementById('value2');
        const form1_val3 = document.getElementById('value3');

        const form2 = document.getElementById('form2');
        const form4 = document.getElementById('form4');

        // form 2 inputs
        const checkEmailForm2 = document.getElementById('check_form2');
        const emailForm2 = document.getElementById('email_form2');

        // form 4 inputs
        const phoneForm4 = document.getElementById('phone-form4');
        const reasonForm4 = document.getElementById('reason-form4');

        const CallYes = document.getElementById('call-yes');
        const CallNo = document.getElementById('call-no');

        // form2wrapper.style.setProperty('display', 'none', 'important');
        // form3wrapper.style.setProperty('display', 'none', 'important');
        
        buttonEvaluation.addEventListener('click', function() {
            if(form1_val3.checked || form1_val2.checked || form1_val1.checked) {
                form1wrapper.style.setProperty('display', 'none', 'important');
            }
            if(form1_val3.checked || form1_val2.checked) {
                form2wrapper.style.removeProperty('display');
            }
            else if(form1_val1.checked) {
                form3wrapper.style.removeProperty('display');
            }
        });
     
        form2.onsubmit = function (e) {
            e.preventDefault();
            const data = {
                type: "FEEDBACK_ACTION",
                email: checkEmailForm2.checked ? emailForm2.value : null,
                content: {evaluation: "Zákazník byl naprosto spokojen"}
            };
            console.log(data);
            
            window.parent.postMessage(data, "*");
        }

        form4.onsubmit = function (e) {
            e.preventDefault();
            const data = {
                type: "FEEDBACK_ACTION",
                email: null,
                content: {
                    evaluation: "Zákazník nebyl spokojen", 
                    zavolat_znovu: true, 
                    phone: phoneForm4.value,
                    reason: reasonForm4.value
                }
            }
            console.log(data);

            window.parent.postMessage(data, "*");
        }

        CallNo.addEventListener('click', function() {
            form3wrapper.style.setProperty('display', 'none', 'important');
            form2wrapper.style.removeProperty('display');
        });

        CallYes.addEventListener('click', function() {
            form3wrapper.style.setProperty('display', 'none', 'important');
            form4wrapper.style.removeProperty('display');
        });

    </script>
  </body>
</html>
