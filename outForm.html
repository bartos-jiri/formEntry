<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <link rel='stylesheet prefetch' href='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/css/bootstrap.min.css'>
    <style type="text/css">
      html, body {
        width: 100%;
        height: 100%;
        background-color: transparent;
      }
      .OutForm {
        display: flex;
        flex-flow: column;
        width: 100%;
        height: 100%;
        justify-content: center;
        align-items: center;
      }
      .my-form {
        width: 100%;
        max-height: 100%;
        overflow: auto;
        padding: 1rem;
      }
      .form-control, .btn {
        border-radius: 8px;
      }
      .btn[type="submit"], #Form1-submit {
        background-color: #005a97; /* Barva talčítka */
        color: white; /* Barva textu tlačítka */
        
      }
      #Form1-submit {
        width: 200px;
        margin: 0 auto;
      }
      /* #page_1 {
        width: 100%;
      } */
      .form-text {
        text-align: center;
        padding: 0 20px;
        display: block;
        margin-bottom: 25px;
      }
      #Form1-form {
          width: 160px;
        margin: 0 auto;
      }
      #Form2, #Form2-form {
        width: 100%;
      }
      #Form2-form {
          padding: 20px;
      }
      .Form3-text {
          margin: 30px 0;
      }
      .Form3-text--first {
          margin: 0 0 80px 0;
      }
      #Form3-Yes {
        background-color: #005a97; /* Barva talčítka */
        border: none;
      }
      #Form3-No {
        background-color: #2E78A9; /* Barva talčítka */
        border: none;        
      }
      #Hints {
        position: absolute;
        top: 0;
        width: 100%;
        height: 32px;
        background-color: #f16663;
        color: #fff;
        text-align: center;
        padding: 8px;
        font-size: 12px;
        box-sizing: border-box;
      }
      .bold {
          font-weight: bold;
      }
      .call-buttons {
          margin: 20px auto 0;
          text-align: center;
      }
      .call-button {
          width: 150px;
      }
      .btn-200 {
          width: 200px;
          margin: 0 auto;
      }
    </style>
  </head>

  <body>
    <div class="OutForm">
        <p id="Hints" style="display: none;"></p>

        <div id="Form1">
            <p class="form-text">Byly Vám naši operátoři nápomocní?</p>
            <form id="Form1-form" class="my-form">

                    <div class="form-check">
                        <label for="Form1-value3" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="Form1-value3" value="3">
                        Naprosto</label>
                    </div>

                    <div class="form-check">
                        <label for="Form1-value2" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="Form1-value2" value="2">            
                        Do jisté míry</label>
                    </div>

                    <div class="form-check">
                        <label for="Form1-value1" class="form-check-label">
                            <input type="radio" class="form-check-input" name="sessionEvaluation" id="Form1-value1" value="1">            
                        Nikoliv</label>
                    </div>
            
            </form>
            <button type="button" class="btn btn-info btn-block" id="Form1-submit">Pokračovat</button>
        </div>

        <div id="Form2" style="display: none !important">
            <p class="form-text">Děkujeme za Vaši zpětnou vazbu.</p>
            <p class="form-text" class="bold">Přejete si poslat přepis emailové konverzace?</p>
            <form class="my-form" id="Form2-form">
                <div class="form-group">
                    <label for="sendConversationEmail" class="form-check-label">
                        <input type="checkbox" class="form-check-input" id="Form2-check" value="">            
                    Chci poslat přepis konverzace</label>
                    <input type="email" class="form-control" id="Form2-email" placeholder="Email">
                </div>
                <div class="form-group">
                    <button type="submit" class="btn btn-info btn-block btn-200">Ok</button>                        
                </div>
            </form>
        </div>

        <div id="Form3" style="display: none !important">
            <p class="form-text Form3-text Form3-text--first">Je nám líto, že jsme Vám nedokázali pomoci.</p>          
            <p class="form-text Form3-text">Chcete, abychom Vás ještě jednou kontaktovali a na věc se znovu podívali?</p>
            <div class="call-buttons">
                <button type="button" class="btn btn-success call-button" id="Form3-Yes">Ano</button>
                <button type="button" class="btn btn-danger call-button" id="Form3-No">Ne</button> 
            </div> 
           
        </div>

        <div id="Form4" style="display: none !important">
            <form id="Form4-form" class="my-form" novalidate>

                <div class="form-group">
                    <label for="Form4-phone">Vyplňte, prosím, Vaše telefonní číslo, kam Vám můžeme zavolat.</label>
                    <input type="text" class="form-control" id="Form4-phone" placeholder="Telefon" required>
                </div>
                <div class="form-group">
                    <label for="Form4-reason">Popište prosím, v čem Vám můžeme pomoci.</label>
                    <textarea cols="30" rows="5" class="form-control" id="Form4-reason" placeholder="Zde můžete popsat Váš problém"></textarea>
                </div>
                
                <button type="submit" class="btn btn-info btn-block btn-200">Zavolejte mi</button>
            </form>
        </div>
            
    </div>

    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.0.8/popper.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta/js/bootstrap.min.js'></script>
    <script type="text/javascript">
        const Form1 = document.getElementById('Form1');
        const Form2 = document.getElementById('Form2');
        const Form3 = document.getElementById('Form3');
        const Form4 = document.getElementById('Form4');

        // form 1
        const Form1Value1 = document.getElementById('Form1-value1');
        const Form1Value2 = document.getElementById('Form1-value2');
        const Form1Value3 = document.getElementById('Form1-value3');
        const Form1Submit = document.getElementById('Form1-submit');

        // form 2
        const Form2Form = document.getElementById('Form2-form');
        const Form2Check = document.getElementById('Form2-check');
        const Form2Email = document.getElementById('Form2-email');

        // form 3
        const Form3Yes = document.getElementById('Form3-Yes');
        const Form3No = document.getElementById('Form3-No');

        // form 4
        const Form4Form = document.getElementById('Form4-form');
        const Form4Phone = document.getElementById('Form4-phone');
        const Form4Reason = document.getElementById('Form4-reason');

        const Hints = document.getElementById('Hints');

        let evaluation;
        
        Form1Submit.addEventListener('click', function() {
            Hints.style.setProperty('display', 'none', 'important');
            
            if(Form1Value3.checked || Form1Value2.checked || Form1Value1.checked) {
                Form1.style.setProperty('display', 'none', 'important');
            }
            if(Form1Value3.checked) {
                evaluation = 'Naprosto spokojený';
                Form2.style.removeProperty('display');
            }
            else if (Form1Value2.checked) {
                evaluation = 'Do jisté míry spokojený';                
                Form2.style.removeProperty('display');
            }
            else if(Form1Value1.checked) {
                evaluation = 'Nespokojený';                                
                Form3.style.removeProperty('display');
            }
            else {
                Hints.innerText = 'Dejte nám prosím feedback!';
                Hints.style.removeProperty('display');
            }
        });
     
        Form2Form.onsubmit = function (e) {
            e.preventDefault();
            const data = {
                type: "FEEDBACK_ACTION",
                email: Form2Check.checked ? Form2Email.value : null,
                content: evaluation
            };
            console.log(data);
            
            window.parent.postMessage(data, "*");
        }

        Form4Form.onsubmit = function (e) {
            e.preventDefault();

            const regPhone = new RegExp('^\\d{9}$');

            if(!regPhone.test(Form4Phone.value)) {
                Hints.innerText = 'Zadejte prosím devítimístné číslo';
                Hints.style.removeProperty('display'); 
                return false
            }

            Hints.style.setProperty('display', 'none', 'important');

            const data = {
                type: "FEEDBACK_ACTION",
                email: null,
                content: evaluation
            }
            console.log(data);

            window.parent.postMessage(data, "*");
        }

        Form3No.addEventListener('click', function() {
            Form3.style.setProperty('display', 'none', 'important');
            Form2.style.removeProperty('display');
        });

        Form3Yes.addEventListener('click', function() {
            Form3.style.setProperty('display', 'none', 'important');
            Form4.style.removeProperty('display');
        });

    </script>
  </body>
</html>
